Данный проект состоит из двух основных файлов: `cluster_solver.py` и `main_solver.py`.

## `cluster_solver.py`

Этот файл содержит базовые функции для выполнения кластеризации методом k-медоидов.

### Функции:

1.  `euclidean_distance(p1, p2)`:
    -   **Назначение**: Вычисляет евклидово расстояние между двумя точками `p1` и `p2`.
    -   **Параметры**:
        -   `p1` (tuple): Координаты первой точки (x, y).
        -   `p2` (tuple): Координаты второй точки (x, y).
    -   **Возвращает**: Расстояние (float).

2.  `calculate_sum_distances(point, cluster_points)`:
    -   **Назначение**: Вычисляет сумму евклидовых расстояний от заданной `point` до всех остальных точек в списке `cluster_points`.
    -   **Параметры**:
        -   `point` (tuple): Точка, для которой вычисляется сумма расстояний.
        -   `cluster_points` (list of tuples): Список точек в кластере.
    -   **Возвращает**: Сумма расстояний (float).

3.  `find_cluster_center(cluster_points)`:
    -   **Назначение**: Находит центр кластера (медоид) для заданного набора точек. Центром кластера считается та точка из кластера, сумма расстояний от которой до всех остальных точек кластера минимальна.
    -   **Параметры**:
        -   `cluster_points` (list of tuples): Список точек, принадлежащих кластеру.
    -   **Возвращает**: Координаты центра кластера (tuple).

4.  `k_medoids_single_run(points, k, max_iterations=100)`:
    -   **Назначение**: Выполняет один прогон алгоритма k-медоидов.
    -   **Параметры**:
        -   `points` (list of tuples): Все точки данных.
        -   `k` (int): Желаемое количество кластеров.
        -   `max_iterations` (int): Максимальное количество итераций для алгоритма.
    -   **Возвращает**:
        -   `clusters` (list of lists of tuples): Список кластеров, где каждый кластер - это список точек.
        -   `medoids` (list of tuples): Список медоидов (центров) для каждого кластера.
        -   `total_within_cluster_distance` (float): Сумма расстояний от каждой точки до ее медоида в этом прогоне.

5.  `k_medoids(points, k, num_runs=50, max_iterations=100)`:
    -   **Назначение**: Запускает алгоритм `k_medoids_single_run` несколько раз (`num_runs`) и выбирает лучший результат (тот, у которого минимальная общая сумма расстояний внутри кластеров). Это помогает избежать попадания в локальные оптимумы, так как инициализация медоидов происходит случайным образом.
    -   **Параметры**:
        -   `points` (list of tuples): Все точки данных.
        -   `k` (int): Желаемое количество кластеров.
        -   `num_runs` (int): Количество запусков алгоритма.
        -   `max_iterations` (int): Максимальное количество итераций для каждого прогона.
    -   **Возвращает**:
        -   `best_clusters` (list of lists of tuples): Лучший набор кластеров.
        -   `best_medoids` (list of tuples): Медоиды для лучшего набора кластеров.

## `main_solver.py`

Этот файл отвечает за чтение данных, применение алгоритма кластеризации, выполнение расчетов и визуализацию результатов.

### Функции:

1.  `read_points_from_file(filepath)`:
    -   **Назначение**: Читает координаты точек из текстового файла.
    -   **Параметры**:
        -   `filepath` (str): Путь к файлу.
    -   **Возвращает**: Список кортежей (x, y) с координатами точек.

2.  `identify_anomalous_points(points, num_anomalies=3)`:
    -   **Назначение**: Автоматически определяет аномальные точки в наборе данных. Аномальными считаются точки, сумма расстояний от которых до всех остальных точек в наборе наибольшая.
    -   **Параметры**:
        -   `points` (list of tuples): Все точки данных.
        -   `num_anomalies` (int): Количество аномальных точек, которые нужно найти.
    -   **Возвращает**: Список аномальных точек.

### Основной блок кода:

1.  **Обработка Файла А**:
    -   Читает точки из файла `27_A_23209.txt`.
    -   Применяет алгоритм k-медоидов для кластеризации точек на 2 кластера.
    -   Находит центры (медоиды) для каждого кластера.
    -   Вычисляет `Px` (максимальная абсцисса из центров кластеров) и `Py` (максимальная ордината из центров кластеров).

2.  **Обработка Файла Б**:
    -   Читает точки из файла `27_B_23209.txt`.
    -   Использует функцию `identify_anomalous_points` для автоматического определения и исключения 3 аномальных точек.
    -   Применяет алгоритм k-медоидов для кластеризации оставшихся точек на 3 кластера.
    -   Находит центры (медоиды) для каждого кластера.
    -   Определяет кластеры с минимальным и максимальным количеством точек.
    -   Вычисляет `Qx` (разность абсцисс центров кластеров с минимальным и максимальным количеством точек) и `Qy` (разность ординат центров кластеров с минимальным и максимальным количеством точек).

3.  **Вывод результатов**:
    -   Выводит значения `Px`, `Py`, `Qx`, `Qy`, умноженные на 10000 и преобразованные в целые числа, как того требует задача.

4.  **Визуализация**:
    -   Использует библиотеку `matplotlib` для создания двух графиков: один для кластеров из Файла А, другой для кластеров из Файла Б.
    -   На графиках отображаются точки данных, центры кластеров (медоиды) и аномальные точки (для Файла Б).
    -   Графики сохраняются в файл `clustering_visualization.png`.

## Примечания к алгоритму кластеризации:

-   **k-медоиды**: В отличие от k-средних, k-медоиды выбирают в качестве центра кластера (медоида) реальную точку из кластера, что делает его более устойчивым к выбросам.
-   **Множественные запуски**: Поскольку инициализация медоидов случайная, алгоритм может сходиться к разным локальным оптимумам. Многократные запуски с выбором лучшего результата помогают найти более оптимальное решение.
-   **Определение аномалий**: Аномальные точки определяются как те, которые имеют наибольшую сумму расстояний до всех остальных точек. Это простой, но эффективный способ выявления выбросов в данном контексте.
